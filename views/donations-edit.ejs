<%- include("partials/header") %>
<%- include("partials/nav") %>

<h1 class="section-header"><%= mode === "edit" ? "Edit Donation" : "Add Donation" %></h1>

<div class="card">

    <form action="/donations/save" method="POST" class="form-layout">

        <% if (mode === "edit") { %>
            <input type="hidden" name="OriginalEmail" value="<%= donation.ParticipantEmail %>">
            <input type="hidden" name="OriginalDate" value="<%= donation['Donation Date'] %>">
        <% } %>

        <% 
            const editDate = (donation && donation["Donation Date"] !== "UNKNOWN_DATE")
                ? donation["Donation Date"]
                : "";

            const editAmt = donation 
                ? (donation["Donation Amount"] || "").replace("$", "").trim()
                : "";
        %>

        <div class="form-group">
            <label>Participant Email</label>
            <input type="email" name="ParticipantEmail"
                   value="<%= donation ? donation.ParticipantEmail : '' %>" required>
        </div>

        <div class="form-group">
            <label>Donation Date</label>
            <input type="text" name="DonationDate"
                   value="<%= editDate %>" required>
        </div>

        <div class="form-group">
            <label>Donation Amount</label>
            <input type="number" step="0.01" name="DonationAmount"
                   value="<%= editAmt %>" required>
        </div>

        <div class="form-actions">
            <button class="btn btn-primary">
                <%= mode === "edit" ? "Save Donation" : "Add Donation" %>
            </button>
            <a class="btn btn-secondary" href="/donations">Cancel</a>
        </div>

    </form>

</div>

<%- include("partials/footer") %>
